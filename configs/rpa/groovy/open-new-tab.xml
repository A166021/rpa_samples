<?xml version="1.0" encoding="UTF-8"?>
<config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config" scriptlang="groovy">
    <selenium-flow>
        <!-- {{ open IE browser in private mode, after open 2 windows and etc -->
        <selenium name="seleniumDriver" browser="internet explorer" close-on-completion="true" start-in-private="true">
            <script><![CDATA[
          		import java.util.concurrent.TimeUnit;
          		 
                driver = seleniumDriver.getWrappedObject();
                driver.manage().timeouts().implicitlyWait(1, TimeUnit.MINUTES).pageLoadTimeout(1, TimeUnit.MINUTES); 
                
                // open google.com page
                driver.get("http://www.google.com");
  
  				// detect language in open window
 				notEnglish = driver.getPageSource().contains("English"); 
  				// if language isn't English -> change it
  				if(notEnglish) {
  					element = driver.findElement(By.linkText("English"));
  					element.click();
  				}
  				// }}
  				
  				// open gmail page in new tab
        		element = driver.findElement(By.linkText("Gmail"));
        		actionOpenLinkInNewTab = new Actions(driver);
       	 		actionOpenLinkInNewTab.moveToElement(element).keyDown(Keys.CONTROL).click(element).keyUp(Keys.CONTROL).perform();
         
         		// get tab list
        		tabs = new ArrayList (driver.getWindowHandles());
        		
        		// switch to the second tab and change cite to the yahoo.com 
        		driver.switchTo().window(tabs.get(1));
        		driver.get("http://www.yahoo.com");
        		TimeUnit.SECONDS.sleep(5);
        		// close yahoo.com
        		driver.close();
         
         		// switch ti the first tab and change cite to the msn.com
        		driver.switchTo().window(tabs.get(0));
        		driver.get("http://www.msn.com");
				
				// wait viewing
				TimeUnit.SECONDS.sleep(5);
            ]]></script>
        </selenium>
        <!-- }} open IE browser in private mode, after open 2 windows and etc -->
    </selenium-flow>
    
    <export include-original-data="true"/>
</config>