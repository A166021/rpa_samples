<?xml version="1.0" encoding="UTF-8"?>
<config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config" scriptlang="groovy">
    <selenium-flow>
        <selenium name="seleniumDriver" browser="internet explorer" close-on-completion="false" start-in-private="true">
           <script><![CDATA[
				import java.util.concurrent.TimeUnit;
                         
				ieDriver = seleniumDriver.getWrappedObject();
				ieDriver.manage().timeouts().implicitlyWait(1, TimeUnit.MINUTES).pageLoadTimeout(1, TimeUnit.MINUTES);
	           
				ieDriver.get("http://google.com");
	           
	           	searchDataField = ieDriver.findElement(By.id("lst-ib"));
	           	searchDataField.click();
				searchDataField.sendKeys("form example");
				
				ieDriver.findElement(By.name("btnK")).click();
				
				ieDriver.openLinkInNewWindow(By.xpath("(//h3[@class='r']/a)[2]"));
			   
				TimeUnit.SECONDS.sleep(5);

	           	parentWindow = ieDriver.getWindowHandle();
			   	def handles =  ieDriver.getWindowHandles();
			   	
				println "Open windows list size = " + handles.size();
				
				handles.each {
					if(!it.equals(parentWindow)){
						ieDriver.switchTo().window(it);
						ieDriver.manage().window().maximize();
					
						println "Current page title = " + ieDriver.getTitle();
						
						ieDriver.switchTo().frame(ieDriver.findElement(By.xpath("//iframe[@src='demo_form_validation_complete.php']")));
					
			         	// this way we can switch focus to our control in opened window 
			         	name	= ieDriver.findElement(By.name("name"));
			         	name.click();
			         	name.sendKeys("Andrey");
			         	
			         	email	= ieDriver.findElement(By.name("email"));
			         	email.click();
			         	email.sendKeys("aharhots@gmail.com");
			         	
			         	website	= ieDriver.findElement(By.name("website"));
			         	website.click();
			         	website.sendKeys("wfs.com");
			         	
			         	comment	= ieDriver.findElement(By.name("comment"));
			         	comment.click();
			         	comment.sendKeys("some comment");
			         	
			         	genderCheckBox = ieDriver.findElements(By.name("gender"));
			         	genderCheckBox.get(1).click();
			         	
			         	ieDriver.findElement(By.name("submit")).click();
			         	
						TimeUnit.SECONDS.sleep(10);
						
						ieDriver.switchTo().window(parentWindow);
					}
				}
				ieDriver.closeAllWindows();
           ]]></script>
        </selenium>
    </selenium-flow>

    <export include-original-data="true"/>
</config>