<?xml version="1.0" encoding="UTF-8"?>
<config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config">
     <selenium-flow>
		<!-- Internet explorer driver -->
        <selenium name="seleniumDriver" browser="internet explorer" close-on-completion="false" start-in-private="true">
            <script><![CDATA[
 				// import timeUnit library for setup timeouts
            	import java.util.concurrent.TimeUnit;
       			// get web browser and setup 
                ieDriver = seleniumDriver.getWrappedObject();
                ieDriver.manage().timeouts().implicitlyWait(1, TimeUnit.MINUTES).pageLoadTimeout(1, TimeUnit.MINUTES);
               	// get web page
                ieDriver.get("http://stretiakov.s3.amazonaws.com/applet/base-page.html");
                // timeout for view
				TimeUnit.SECONDS.sleep(2);                
				// click link to open applet
                ieDriver.findElement(By.partialLinkText("Open applet")).click();
            ]]></script>
        </selenium>
		<!-- AutoIt driver -->
        <selenium name="autoitDriver" browser="autoit" close-on-completion="false">
            <script><![CDATA[
				// import timeUnit library for setup timeouts
            	import java.util.concurrent.TimeUnit;
            	// get autoit driver and setup
                autoitDriver = autoitDriver.getWrappedObject();
                autoitDriver.manage().timeouts().implicitlyWait(1, TimeUnit.MINUTES);
                // Switch to applet window.
                autoitDriver.switchTo().window("[CLASS:SunAwtFrame;TITLE:Frame]");
                // Click on button.
                autoitDriver.findElement(By.cssSelector("[CLASS: JButton]")).click();
                // timeout for view
                TimeUnit.SECONDS.sleep(2);
                // Add value to cell.
                autoitDriver.findElement(By.cssSelector("[CLASS: JTable; CELL: 0,0]")).sendKeys(" value{ENTER}");
                // timeout for view
                TimeUnit.SECONDS.sleep(1);
                // Clear cell.
                autoitDriver.findElement(By.cssSelector("[CLASS: JTable; CELLTEXT: row2-col3]")).clear();
                // timeout for view
                TimeUnit.SECONDS.sleep(1);
				// Copy cell value
				text = autoitDriver.findElement(By.cssSelector("[CLASS: JTable; CELL:0,0]")).getText();
            	// Paste text to cell
            	autoitDriver.findElement(By.cssSelector("[CLASS: JTable; CELL:1,1]")).sendKeys(text);
            	// timeout for view
            	TimeUnit.SECONDS.sleep(3);
            ]]></script>
        </selenium>
		<!-- close IE window -->
        <selenium name="seleniumDriver" browser="internet explorer" close-on-completion="true"/>
    </selenium-flow>

	<!-- Export values to the output CSV file -->
    <export include-original-data="false"/>
</config>