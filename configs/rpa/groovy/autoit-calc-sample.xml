<?xml version="1.0" encoding="UTF-8"?>
<config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config" scriptlang="groovy">
    <selenium-flow>
		<!-- AutoIt driver -->
        <selenium name="seleniumDriver" browser="autoit" close-on-completion="true">
            <script><![CDATA[
             	timeouts(10 * 1000)
 				// make result map
          		rpaVariables = [:];
                //---------------------------------------------
				// {{ start calc.exe and switch to calc window
				// You should download and install old calc application and call calc1.exe
				// 		if you run it on Windows 10.
                open("calc.exe");
                window("[CLASS:CalcFrame]");
                // }} start calc.exe and switch to calc window
                //---------------------------------------------
                // try calc
                expressions = ["2*4*8*16=", "5*5=", "10/2="]
                sys.defineVariable("expressions", expressions)
                expressions.each {
                	// calc sample
                	sample = it.toString();
                	// calc
                	sendKeys(Keys.DELETE);
                	sendKeys(sample);
	                // get calc result
	                result = $(By.cssSelector("")).getAttribute("ACTION_SELECT_ALL_TEXT_AND_COPY");
	                // set calc result to result map
	                rpaVariables.put(sample.toString(), result.toString());
                }
                //---------------------------------------------
                // return calc result map to the sys var
                sys.defineVariable("rpaVariables", rpaVariables)
            ]]></script>
        </selenium>
    </selenium-flow>

	<!-- Export values to the output CSV file -->
    <export include-original-data="true">
        <loop item="rpaVar">
            <list>
                <var name="expressions"/>
            </list>
            <body>
                <single-column name="${rpaVar}">
                    <template>${rpaVariables.getWrappedObject().get(rpaVar.toString())}</template>
                </single-column>
            </body>
        </loop>
    </export>
	
</config>