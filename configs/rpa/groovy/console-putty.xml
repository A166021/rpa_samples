<?xml version="1.0" encoding="UTF-8"?>
<config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config" scriptlang="groovy">
    <selenium-flow>
      <selenium name="seleniumDriver" browser="autoit" close-on-completion="true">
        <script><![CDATA[
        	import java.util.concurrent.TimeUnit;
        	
            driver = seleniumDriver.getWrappedObject();
			driver.manage().timeouts().implicitlyWait(1, TimeUnit.MINUTES);
			                              
			driver.get("putty.exe -ssh traning@traning-ssh.workfusion.com -pw dEFgEmzL");

			TUS = TimeUnit.SECONDS;
			TUS.sleep(5);
			
            driver.switchTo().window("[CLASS:PuTTY]");
			TUS.sleep(2);
			
			keyboard = driver.getKeyboard();

			keyboard.sendKeys("vim 123.txt{ENTER}");
			TUS.sleep(2);
            
            // copy all console content into variable
            def windowContent = driver.findElement(By.cssSelector("")).getAttribute("ACTION_PUTTY_COPY_ALL_TEXT");
			TUS.sleep(2);

            // delete row command
            keyboard.sendKeys("dd");
            keyboard.sendKeys("{TAB}");
            keyboard.sendKeys("{UP}{UP}{DOWN}{DOWN}");

            // switch to edit mode
            keyboard.sendKeys("i");
			TUS.sleep(2);

			// edit text file
            keyboard.sendKeys("{UP}{DOWN}{RIGHT}{RIGHT}{TAB}{TAB}");
            keyboard.sendKeys("Hello, World{!}");

            keyboard.sendKeys("{CTRLDOWN}c{CTRLUP}");
            keyboard.sendKeys(":q{!}");

            keyboard.sendKeys("{ENTER}");
			TUS.sleep(2);
            keyboard.sendKeys("{CTRLDOWN}d{CTRLUP}"); 
        ]]></script>
      </selenium>
    </selenium-flow>
    <export include-original-data="true"/>    
</config>